<!--パターン作成ページ-->

<!--ページ上部-->
<div class="makings__edit--top">
  <%= form_with( url: making_path, method: :patch ) do | f | %>
  <!--ページ上部のタイトル-->
  <h3>
    パターン編集エリア
    <%= render 'makings/edit_helper' %>
    <!--「変更を保存」ボタンはdisplay: none;がデフォルト設定-->
    <%= f.submit '変更を保存', id: "makings__edit--update", class: "btn btn-success" %>
  </h3>
  <!--作成中パターンのID-->
  <%= f.hidden_field :id, value: @making.id, readonly: true %>
  <!--作成中パターンの編集エリア-->
  <%= f.text_area :making_text, value: @making_bit_strings_array.join( "\n" ), class: "makings__edit--textarea", rows: @making_bit_strings_array.size, type: 'number' %>
  <% end %>
</div>

<!--ページ下部-->
<div class="makings__edit--bottom">
  <!--ページ上部のタイトル-->
  <h3>作成中のパターン</h3>
  <!--ライフゲームエミュレート画面-->
  <%= render 'patterns/emulation' %>

<!--パターン新規作成画面への移動アクション-->
<button type="button" name="movePatternsNew" id="patterns__new" class="btn btn-default" onclick="jumpPatternsNew('<%= new_pattern_path %>');">
  <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
  このパターンを投稿する（パターン情報入力ページへ）
</button>
</div>

<script type="text/javascript">
  // パターンアップデート前のバリデーションメソッド
  $(function(){
    $("form").submit( function() {
      // アクション名を取得
      let actionName = $(this).attr('action');
      // メソッド名を取得
      let methodName = $(this).attr('method');
      // Makings#updateである場合
      if ( /making/.test(actionName) && /post/i.test( methodName ) ) {
        // 提出前のバリデーション実行 => falseなら送信中止
        return verificationMakingPattern();
      }
    });
  });
</script>
